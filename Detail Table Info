-- Check Detail Table Info Size Pages 


SELECT 
    t.name AS TableName,
    s.name AS SchemaName,
    p.rows AS RowsCount,
	SUM(a.total_pages) total_pages,
	SUM(a.used_pages) used_pages,
	SUM(a.data_pages) data_pages, 
	SUM(a.total_pages)  - SUM(a.used_pages) Unused_pages,
    CAST(ROUND((SUM(a.total_pages) * 8.0) / 1024 / 1024, 2) AS DECIMAL(10,2)) AS TotalSizeGB,
    CAST(ROUND((SUM(a.used_pages) * 8.0) / 1024 / 1024, 2) AS DECIMAL(10,2)) AS UsedSizeGB,
    CAST(ROUND((SUM(a.data_pages) * 8.0) / 1024 / 1024, 2) AS DECIMAL(10,2)) AS DataSizeGB,
    CAST(ROUND(((SUM(a.total_pages) - SUM(a.used_pages)) * 8.0) / 1024 / 1024, 2) AS DECIMAL(10,2)) AS UnusedSizeGB
FROM sys.tables t
INNER JOIN sys.indexes i ON t.object_id = i.object_id
INNER JOIN sys.partitions p ON i.object_id = p.object_id AND i.index_id = p.index_id
INNER JOIN sys.allocation_units a ON p.partition_id = a.container_id
INNER JOIN sys.schemas s ON t.schema_id = s.schema_id
where t.name = 'TableName'
GROUP BY t.name, s.name, p.rows
ORDER BY TotalSizeGB DESC;
